# Backend application
APP_NAME="FlashVSR API"
APP_VERSION="0.1.0"
DEBUG=false
API_V1_PREFIX="/api"

# Database (hosted locally via docker-compose.dev.yml)
DATABASE_URL="postgresql+psycopg2://flashvsr:flashvsr@localhost:5432/flashvsr"

# Redis / Celery (hosted locally via docker-compose.dev.yml)
REDIS_URL="redis://localhost:6379/0"
CELERY_BROKER_URL="redis://localhost:6379/1"
CELERY_RESULT_BACKEND="redis://localhost:6379/2"

# Storage / Model paths (相对于 backend/ 目录)
STORAGE_ROOT="./storage"
MODEL_ROOT="./models"
FLASHVSR_MODEL_PATH="./models/FlashVSR-v1.1"
FLASHVSR_VERSION="v1.1"
# 控制 KV cache 下放策略：auto|cpu|none
FLASHVSR_CACHE_OFFLOAD="auto"
# auto 模式下的显存阈值（GB）
FLASHVSR_CACHE_OFFLOAD_AUTO_THRESHOLD_GB=19.0
# 纯内存 LQ 流式缓冲上限（0 表示不限，一律阻塞等待而非写 memmap；其余支持 8GB/512MB/字节数写法）
FLASHVSR_STREAMING_LQ_MAX_BYTES=8GB
# 流式缓冲在启动推理前至少预读的帧数（需满足 8n+1 上界，例如 25）
FLASHVSR_STREAMING_PREFETCH_FRAMES=25
# 纯内存流式缓冲使用的 CPU 解码线程数量
FLASHVSR_STREAMING_DECODE_THREADS=2
# 超过该帧数时会启用分片写入（0 表示关闭）
FLASHVSR_CHUNKED_SAVE_MIN_FRAMES=600
# 每个分片包含的帧数
FLASHVSR_CHUNKED_SAVE_CHUNK_SIZE=240
FFMPEG_BINARY="ffmpeg"
FFPROBE_BINARY="ffprobe"
PREPROCESS_FFMPEG_PRESET="fast"
PREPROCESS_FFMPEG_CRF=21
# 设置视频编码器（libx264|h264_nvenc|libx265|hevc_nvenc）
PREPROCESS_FFMPEG_VIDEO_CODEC="libx264"
# 可选：启用硬件加速解码（"cuda"）
PREPROCESS_FFMPEG_HWACCEL="cuda"
# NVENC 参数（仅在 *nvenc 编码器时生效）
PREPROCESS_NVENC_PRESET="p5"
PREPROCESS_NVENC_RC="vbr_hq"
PREPROCESS_NVENC_CQ=21
# 可选：覆盖 prompt tensor 路径（默认读取 third_party/FlashVSR/.../posi_prompt.pth）
# FLASHVSR_PROMPT_TENSOR_PATH="./models/FlashVSR-v1.1/posi_prompt.pth"
MAX_UPLOAD_SIZE=2147483648
TASK_RETENTION_DAYS=30
DEFAULT_MODEL_VARIANT="tiny_long"

# Default processing parameters
DEFAULT_SCALE=2.0
DEFAULT_SPARSE_RATIO=2.0
DEFAULT_LOCAL_RANGE=11
DEFAULT_SEED=0

# 模型预加载（可选，JSON 列表格式，例如 ["tiny","full"]）
MODEL_VARIANTS_TO_PRELOAD='["tiny"]'
